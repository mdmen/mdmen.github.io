<script is:inline>
  function getCurrentTheme() {
    return "theme" in localStorage
      ? localStorage.getItem("theme")
      : window.matchMedia("(prefers-color-scheme: dark)").matches
        ? "dark"
        : "light";
  }

  document.addEventListener("DOMContentLoaded", () => {
    window
      .matchMedia("(prefers-color-scheme: dark)")
      .addEventListener("change", (event) => {
        localStorage.removeItem("theme");
        document.documentElement.dataset.theme = event.matches
          ? "dark"
          : "light";
      });
  });

  function syncTheme() {
    if (getCurrentTheme() !== "light") {
      document.documentElement.dataset.theme = "dark";
    }
  }

  document.addEventListener("astro:after-swap", syncTheme);

  syncTheme();
</script>
